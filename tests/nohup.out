First Hessian calculation sow should be True

[ 0.          0.         -1.27500488  0.          0.          0.95655769]
[ 0.          0.         -1.27282284  0.          0.          0.95492064]

Calculating a <class 'optavc.findifcalcs.Hessian'>
Need 3 singlepoints

Warning: thermodynamics relations excluded imaginary frequencies: ['239.2513i']
Warning: thermodynamics relations excluded imaginary frequencies: ['307.1394i']
[ 0.          0.         -1.27500488  0.          0.          0.95655769]
[ 0.          0.         -1.27282284  0.          0.          0.95492064]

Calculating a <class 'optavc.findifcalcs.Hessian'>
Need 3 singlepoints

Warning: thermodynamics relations excluded imaginary frequencies: ['401.3655i']
Warning: thermodynamics relations excluded imaginary frequencies: ['379.7890i']


=============================XTPL-HESS=============================
Energies:
 [-0.32751164397153903, -0.392254673367743, -0.36950483380696925, -0.30881448260523, -112.77688024553551]
final_energy: -113.20443331454364
final_hess:
 [[ 0.         0.         0.         0.         0.         0.       ]
 [ 0.         0.         0.         0.         0.         0.       ]
 [ 0.         0.         0.8452277  0.         0.        -0.8452277]
 [ 0.         0.         0.         0.         0.         0.       ]
 [ 0.         0.         0.         0.         0.         0.       ]
 [ 0.         0.        -0.8452277  0.         0.         0.8452277]]
===================================================================


Second Hessian calculation sow should be False

Warning: thermodynamics relations excluded imaginary frequencies: ['239.2513i']
Warning: thermodynamics relations excluded imaginary frequencies: ['307.1394i']
Warning: thermodynamics relations excluded imaginary frequencies: ['401.3655i']
Warning: thermodynamics relations excluded imaginary frequencies: ['379.7890i']


=============================XTPL-HESS=============================
Energies:
 [-0.32751164397153903, -0.392254673367743, -0.36950483380696925, -0.30881448260523, -112.77688024553551]
final_energy: -113.20443331454364
final_hess:
 [[ 0.         0.         0.         0.         0.         0.       ]
 [ 0.         0.         0.         0.         0.         0.       ]
 [ 0.         0.         0.8452277  0.         0.        -0.8452277]
 [ 0.         0.         0.         0.         0.         0.       ]
 [ 0.         0.         0.         0.         0.         0.       ]
 [ 0.         0.        -0.8452277  0.         0.         0.8452277]]
===================================================================


Third Hessian calculation sow should be False

forrtl: error (78): process killed (SIGTERM)
Image              PC                Routine            Line        Source             
libgdma.so         00002B296DBD710F  for__signal_handl     Unknown  Unknown
libpthread-2.17.s  00002B2961C48630  Unknown               Unknown  Unknown
libc-2.17.so       00002B2961F4A983  __select              Unknown  Unknown
python3.7          000056350AFC59A4  Unknown               Unknown  Unknown
python             000056350AFA472D  _PyMethodDef_RawF     Unknown  Unknown
python             000056350AFA4A31  _PyCFunction_Fast     Unknown  Unknown
python             000056350B010EBD  _PyEval_EvalFrame     Unknown  Unknown
python             000056350AF53829  _PyEval_EvalCodeW     Unknown  Unknown
python             000056350AFA40A5  _PyFunction_FastC     Unknown  Unknown
python             000056350B00C740  _PyEval_EvalFrame     Unknown  Unknown
python             000056350AF53829  _PyEval_EvalCodeW     Unknown  Unknown
python             000056350AFA40A5  _PyFunction_FastC     Unknown  Unknown
python             000056350B010B29  _PyEval_EvalFrame     Unknown  Unknown
python             000056350AF53B0A  _PyEval_EvalCodeW     Unknown  Unknown
python             000056350AFA4107  _PyFunction_FastC     Unknown  Unknown
python             000056350B00C740  _PyEval_EvalFrame     Unknown  Unknown
python             000056350AF53829  _PyEval_EvalCodeW     Unknown  Unknown
python             000056350AFA40A5  _PyFunction_FastC     Unknown  Unknown
python             000056350B010B29  _PyEval_EvalFrame     Unknown  Unknown
python             000056350AF54160  _PyEval_EvalCodeW     Unknown  Unknown
python             000056350AFA4107  _PyFunction_FastC     Unknown  Unknown
python             000056350B00D585  _PyEval_EvalFrame     Unknown  Unknown
python             000056350AFA3E7B  _PyFunction_FastC     Unknown  Unknown
python             000056350B00C4B6  _PyEval_EvalFrame     Unknown  Unknown
python             000056350AF53829  _PyEval_EvalCodeW     Unknown  Unknown
python             000056350AF54714  PyEval_EvalCodeEx     Unknown  Unknown
python             000056350AF5473C  PyEval_EvalCode       Unknown  Unknown
python3.7          000056350B06BF14  Unknown               Unknown  Unknown
python             000056350B076331  PyRun_FileExFlags     Unknown  Unknown
python             000056350B076523  PyRun_SimpleFileE     Unknown  Unknown
python3.7          000056350B077655  Unknown               Unknown  Unknown
python             000056350B07777C  _Py_UnixMain          Unknown  Unknown
libc-2.17.so       00002B2961E77555  __libc_start_main     Unknown  Unknown
python3.7          000056350B01BFF0  Unknown               Unknown  Unknown

====================Beginning new step 0======================

[ 0.          0.         -1.27500488  0.          0.          0.95655769]
[ 0.          0.         -1.27282284  0.          0.          0.95492064]

Calculating a <class 'optavc.findifcalcs.Gradient'>
Need 3 singlepoints


The followin jobs have been resubmitted: 
[2, 2]


/home/agh66737/mjolnir_local/optavc/optimize.py:42: FutureWarning: Using `psi4.core.set_gradient` (only used internally for C++ optking; deprecated silently in 1.2) is deprecated, and in 1.4 (or whenever Py optking is adopted) it will stop working

  psi4.core.set_gradient(grad)

====================Beginning new step 1======================

[ 0.          0.         -1.24044169  0.          0.          0.93062706]
[ 0.          0.         -1.23825966  0.          0.          0.92899002]

Calculating a <class 'optavc.findifcalcs.Gradient'>
Need 3 singlepoints


The followin jobs have been resubmitted: 
[2, 2]


/home/agh66737/mjolnir_local/optavc/optimize.py:42: FutureWarning: Using `psi4.core.set_gradient` (only used internally for C++ optking; deprecated silently in 1.2) is deprecated, and in 1.4 (or whenever Py optking is adopted) it will stop working

  psi4.core.set_gradient(grad)

====================Beginning new step 2======================

[ 0.          0.         -1.2364664   0.          0.          0.92764464]
[ 0.          0.         -1.23428437  0.          0.          0.9260076 ]

Calculating a <class 'optavc.findifcalcs.Gradient'>
Need 3 singlepoints


The followin jobs have been resubmitted: 
[2, 2]


/home/agh66737/mjolnir_local/optavc/optimize.py:42: FutureWarning: Using `psi4.core.set_gradient` (only used internally for C++ optking; deprecated silently in 1.2) is deprecated, and in 1.4 (or whenever Py optking is adopted) it will stop working

  psi4.core.set_gradient(grad)

====================Beginning new step 3======================

[ 0.          0.         -1.23699376  0.          0.          0.92804028]
[ 0.          0.         -1.23481173  0.          0.          0.92640324]

Calculating a <class 'optavc.findifcalcs.Gradient'>
Need 3 singlepoints


The followin jobs have been resubmitted: 
[2, 2]


/home/agh66737/mjolnir_local/optavc/optimize.py:42: FutureWarning: Using `psi4.core.set_gradient` (only used internally for C++ optking; deprecated silently in 1.2) is deprecated, and in 1.4 (or whenever Py optking is adopted) it will stop working

  psi4.core.set_gradient(grad)

====================Beginning new step 4======================

[ 0.          0.         -1.23693157  0.          0.          0.92799363]
[ 0.          0.         -1.23474954  0.          0.          0.92635659]

Calculating a <class 'optavc.findifcalcs.Gradient'>
Need 3 singlepoints


The followin jobs have been resubmitted: 
[2, 2]


forrtl: error (78): process killed (SIGTERM)
Image              PC                Routine            Line        Source             
libgdma.so         00002AE02A52D10F  for__signal_handl     Unknown  Unknown
libpthread-2.17.s  00002AE01E3ED6D0  Unknown               Unknown  Unknown
libc-2.17.so       00002AE01E6EDEF0  __poll                Unknown  Unknown
select.cpython-36  00002AE025E562F4  Unknown               Unknown  Unknown
python             000055D847822511  _PyCFunction_Fast     Unknown  Unknown
python3.6          000055D8478B246C  Unknown               Unknown  Unknown
python             000055D8478D573A  _PyEval_EvalFrame     Unknown  Unknown
python3.6          000055D84787D056  Unknown               Unknown  Unknown
python3.6          000055D84787E08F  Unknown               Unknown  Unknown
python3.6          000055D8478B2545  Unknown               Unknown  Unknown
python             000055D8478D573A  _PyEval_EvalFrame     Unknown  Unknown
python3.6          000055D84787DE4B  Unknown               Unknown  Unknown
python3.6          000055D8478B2545  Unknown               Unknown  Unknown
python             000055D8478D573A  _PyEval_EvalFrame     Unknown  Unknown
python3.6          000055D84787D056  Unknown               Unknown  Unknown
python3.6          000055D84787E08F  Unknown               Unknown  Unknown
python3.6          000055D8478B2545  Unknown               Unknown  Unknown
python             000055D8478D6457  _PyEval_EvalFrame     Unknown  Unknown
python3.6          000055D84787D641  Unknown               Unknown  Unknown
python3.6          000055D84787E08F  Unknown               Unknown  Unknown
python3.6          000055D8478B2545  Unknown               Unknown  Unknown
python             000055D8478D6457  _PyEval_EvalFrame     Unknown  Unknown
python3.6          000055D84787DE4B  Unknown               Unknown  Unknown
python3.6          000055D8478B2545  Unknown               Unknown  Unknown
python             000055D8478D573A  _PyEval_EvalFrame     Unknown  Unknown
python3.6          000055D84787D056  Unknown               Unknown  Unknown
python3.6          000055D84787E08F  Unknown               Unknown  Unknown
python3.6          000055D8478B2545  Unknown               Unknown  Unknown
python             000055D8478D573A  _PyEval_EvalFrame     Unknown  Unknown
python3.6          000055D84787D056  Unknown               Unknown  Unknown
python3.6          000055D84787E08F  Unknown               Unknown  Unknown
python3.6          000055D8478B2545  Unknown               Unknown  Unknown
python             000055D8478D573A  _PyEval_EvalFrame     Unknown  Unknown
python3.6          000055D84787D326  Unknown               Unknown  Unknown
python3.6          000055D84787E08F  Unknown               Unknown  Unknown
python3.6          000055D8478B2545  Unknown               Unknown  Unknown
python             000055D8478D573A  _PyEval_EvalFrame     Unknown  Unknown
python3.6          000055D84787DE4B  Unknown               Unknown  Unknown
python3.6          000055D8478B2545  Unknown               Unknown  Unknown
python             000055D8478D573A  _PyEval_EvalFrame     Unknown  Unknown
python3.6          000055D84787D056  Unknown               Unknown  Unknown
python3.6          000055D84787E08F  Unknown               Unknown  Unknown
python3.6          000055D8478B2545  Unknown               Unknown  Unknown
python             000055D8478D573A  _PyEval_EvalFrame     Unknown  Unknown
python3.6          000055D84787D056  Unknown               Unknown  Unknown
python3.6          000055D84787E08F  Unknown               Unknown  Unknown
python3.6          000055D8478B2545  Unknown               Unknown  Unknown
python             000055D8478D573A  _PyEval_EvalFrame     Unknown  Unknown
python3.6          000055D84787D48E  Unknown               Unknown  Unknown
python3.6          000055D84787E08F  Unknown               Unknown  Unknown
python3.6          000055D8478B2545  Unknown               Unknown  Unknown
python             000055D8478D6457  _PyEval_EvalFrame     Unknown  Unknown
python3.6          000055D84787DE4B  Unknown               Unknown  Unknown
python3.6          000055D8478B2545  Unknown               Unknown  Unknown
python             000055D8478D573A  _PyEval_EvalFrame     Unknown  Unknown
python             000055D847881749  PyEval_EvalCodeEx     Unknown  Unknown
python             000055D8478824EC  PyEval_EvalCode       Unknown  Unknown
python3.6          000055D847928584  Unknown               Unknown  Unknown
python             000055D847928981  PyRun_FileExFlags     Unknown  Unknown
python             000055D847928B83  PyRun_SimpleFileE     Unknown  Unknown
python             000055D84792C6F7  Py_Main               Unknown  Unknown
python             000055D8477F332E  main                  Unknown  Unknown
libc-2.17.so       00002AE01E61C445  __libc_start_main     Unknown  Unknown
python3.6          000055D8478DC269  Unknown               Unknown  Unknown

====================Beginning new step 0======================

[ 0.          0.         -1.27500488  0.          0.          0.95655769]
[ 0.          0.         -1.27282284  0.          0.          0.95492064]

Calculating a <class 'optavc.findifcalcs.Gradient'>
Need 3 singlepoints

Traceback (most recent call last):
  File "main.py", line 30, in <module>
    optavc.run_optavc('opt', options_kwargs)
  File "/home/agh66737/mjolnir_local/optavc/main.py", line 95, in run_optavc
    return opt_obj.run(restart_iteration, xtpl_restart)
  File "/home/agh66737/mjolnir_local/optavc/optimize.py", line 34, in run
    ref_energy, grad = self.xtpl_grad(iteration, restart_iteration, xtpl_restart)
  File "/home/agh66737/mjolnir_local/optavc/optimize.py", line 172, in xtpl_grad
    grad_obj=grad_obj)
  File "/home/agh66737/mjolnir_local/optavc/optimize.py", line 123, in single_grad
    grad = grad_obj.compute_result()
  File "/home/agh66737/mjolnir_local/optavc/findifcalcs.py", line 147, in compute_result
    self.run()
  File "/home/agh66737/mjolnir_local/optavc/findifcalcs.py", line 293, in run
    super().run()
  File "/home/agh66737/mjolnir_local/optavc/findifcalcs.py", line 105, in run
    self.job_ids = self.run_individual()
  File "/home/agh66737/mjolnir_local/optavc/findifcalcs.py", line 91, in run_individual
    return [singlepoint.run() for singlepoint in self.singlepoints]
  File "/home/agh66737/mjolnir_local/optavc/findifcalcs.py", line 91, in <listcomp>
    return [singlepoint.run() for singlepoint in self.singlepoints]
  File "/home/agh66737/mjolnir_local/optavc/singlepoint.py", line 99, in run
    output = self.cluster.submit(self.options)
  File "/home/agh66737/mjolnir_local/optavc/cluster.py", line 77, in submit
    encoding='UTF-8')
  File "/usr/local/apps/gb/PSI4/1.3.2/lib/python3.6/subprocess.py", line 403, in run
    with Popen(*popenargs, **kwargs) as process:
  File "/usr/local/apps/gb/PSI4/1.3.2/lib/python3.6/subprocess.py", line 709, in __init__
    restore_signals, start_new_session)
  File "/usr/local/apps/gb/PSI4/1.3.2/lib/python3.6/subprocess.py", line 1344, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
PermissionError: [Errno 13] Permission denied: 'sbatch'

====================Beginning new step 0======================

[ 0.          0.         -1.27500488  0.          0.          0.95655769]
[ 0.          0.         -1.27282284  0.          0.          0.95492064]

Calculating a <class 'optavc.findifcalcs.Gradient'>
Need 3 singlepoints

/home/agh66737/mjolnir_local/optavc/optimize.py:42: FutureWarning: Using `psi4.core.set_gradient` (only used internally for C++ optking; deprecated silently in 1.2) is deprecated, and in 1.4 (or whenever Py optking is adopted) it will stop working

  psi4.core.set_gradient(grad)

====================Beginning new step 1======================

[ 0.          0.         -1.24044169  0.          0.          0.93062706]
[ 0.          0.         -1.23825966  0.          0.          0.92899002]

Calculating a <class 'optavc.findifcalcs.Gradient'>
Need 3 singlepoints

/home/agh66737/mjolnir_local/optavc/optimize.py:42: FutureWarning: Using `psi4.core.set_gradient` (only used internally for C++ optking; deprecated silently in 1.2) is deprecated, and in 1.4 (or whenever Py optking is adopted) it will stop working

  psi4.core.set_gradient(grad)

====================Beginning new step 2======================

[ 0.          0.         -1.2364664   0.          0.          0.92764464]
[ 0.          0.         -1.23428437  0.          0.          0.9260076 ]

Calculating a <class 'optavc.findifcalcs.Gradient'>
Need 3 singlepoints

/home/agh66737/mjolnir_local/optavc/optimize.py:42: FutureWarning: Using `psi4.core.set_gradient` (only used internally for C++ optking; deprecated silently in 1.2) is deprecated, and in 1.4 (or whenever Py optking is adopted) it will stop working

  psi4.core.set_gradient(grad)

====================Beginning new step 3======================

[ 0.          0.         -1.23699376  0.          0.          0.92804028]
[ 0.          0.         -1.23481173  0.          0.          0.92640324]

Calculating a <class 'optavc.findifcalcs.Gradient'>
Need 3 singlepoints

/home/agh66737/mjolnir_local/optavc/optimize.py:42: FutureWarning: Using `psi4.core.set_gradient` (only used internally for C++ optking; deprecated silently in 1.2) is deprecated, and in 1.4 (or whenever Py optking is adopted) it will stop working

  psi4.core.set_gradient(grad)

====================Beginning new step 4======================

[ 0.          0.         -1.23693157  0.          0.          0.92799363]
[ 0.          0.         -1.23474954  0.          0.          0.92635659]

Calculating a <class 'optavc.findifcalcs.Gradient'>
Need 3 singlepoints

/home/agh66737/mjolnir_local/optavc/optimize.py:42: FutureWarning: Using `psi4.core.set_gradient` (only used internally for C++ optking; deprecated silently in 1.2) is deprecated, and in 1.4 (or whenever Py optking is adopted) it will stop working

  psi4.core.set_gradient(grad)

====================Beginning new step 5======================

[ 0.          0.         -1.23693229  0.          0.          0.92799417]
[ 0.          0.         -1.23475026  0.          0.          0.92635713]

Calculating a <class 'optavc.findifcalcs.Gradient'>
Need 3 singlepoints

/home/agh66737/mjolnir_local/optavc/optimize.py:42: FutureWarning: Using `psi4.core.set_gradient` (only used internally for C++ optking; deprecated silently in 1.2) is deprecated, and in 1.4 (or whenever Py optking is adopted) it will stop working

  psi4.core.set_gradient(grad)


 OPTIMIZATION HAS FINISHED!



====================Beginning new step 0======================


====================Beginning new step 1======================


====================Beginning new step 2======================


Job IDS for forced resubmit
['3298648', '3298649', '3298650']

/home/agh66737/mjolnir_local/optavc/optimize.py:42: FutureWarning: Using `psi4.core.set_gradient` (only used internally for C++ optking; deprecated silently in 1.2) is deprecated, and in 1.4 (or whenever Py optking is adopted) it will stop working

  psi4.core.set_gradient(grad)

====================Beginning new step 3======================


====================Beginning new step 4======================

[ 0.          0.         -1.23693157  0.          0.          0.92799363]
[ 0.          0.         -1.23474954  0.          0.          0.92635659]

Calculating a <class 'optavc.findifcalcs.Gradient'>
Need 3 singlepoints

/home/agh66737/mjolnir_local/optavc/optimize.py:42: FutureWarning: Using `psi4.core.set_gradient` (only used internally for C++ optking; deprecated silently in 1.2) is deprecated, and in 1.4 (or whenever Py optking is adopted) it will stop working

  psi4.core.set_gradient(grad)

====================Beginning new step 5======================

[ 0.          0.         -1.23693229  0.          0.          0.92799417]
[ 0.          0.         -1.23475026  0.          0.          0.92635713]

Calculating a <class 'optavc.findifcalcs.Gradient'>
Need 3 singlepoints

/home/agh66737/mjolnir_local/optavc/optimize.py:42: FutureWarning: Using `psi4.core.set_gradient` (only used internally for C++ optking; deprecated silently in 1.2) is deprecated, and in 1.4 (or whenever Py optking is adopted) it will stop working

  psi4.core.set_gradient(grad)


 OPTIMIZATION HAS FINISHED!


